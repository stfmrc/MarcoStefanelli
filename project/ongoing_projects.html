<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ongoing projects</title>

  <!-- CSS -->
  <link rel="stylesheet" href="../styles/style.css" />
  <link rel="stylesheet" href="../styles/educational.css" />

  <!-- MathJax for LaTeX like \mathcal{H}, \, and dBZ units -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
</head>

<body class="ongoing-projects">
  <header>
    <h1>A neural network-based observation operator for weather radar data assimilation</h1>
  </header>

  <main>
    <p>
      In three-dimensional variational data assimilation (3DVar) for numerical weather prediction (NWP),
      the observation operator H plays a central role by mapping model state variables to an
      observation equivalent. For weather radar, however, specifying H is particularly challenging:
      reflectivity is a nonlinear, microphysics-dependent diagnostic quantity that only indirectly relates to the
      model's prognostic variables, making traditional parameterised radar operators complex, regime-dependent,
      and difficult to tune.
    </p>

    <p>
      In this study, we propose a neural-network (NN)-based observation operator for radar reflectivity and apply it
      within a 3DVar data assimilation (DA) framework. Using five years (2019–2023) of radar reflectivity data from
      the Lisca radar and 4.4km-resolution short-range forecasts from the ALADIN model over Slovenia, we train a
      convolutional encoder–decoder neural network to map model temperature, humidity, horizontal wind components,
      and surface pressure fields to radar reflectivity. Across independent test cases spanning clear-sky, stratiform,
      and convective regimes, the NN-based operator accurately reproduces the spatial structure and intensity of
      observed reflectivity, relying primarily on the model state in the vicinity of the observation point.
    </p>

    <p>
      In the extreme precipitation case that caused widespread floods in Slovenia on August 4, 2023, assimilating the
      full radar disc reduces the domain-averaged reflectivity root-mean-square error (RMSE) from 5.99dBZ to
      3.47dBZ and improves the alignment between the analysed and observed convective bands.
    </p>

    <p>
      Embedded within 3DVar, the Jacobian of the NN observation operator allows radar reflectivity observations to
      inform model state variables, producing corresponding analysis increments. The proposed NN radar observation
      operator offers a flexible alternative to traditional parameterised radar operators for improving
      convective-storm forecasts.
    </p>
    
    <p>
    <a href="https://arxiv.org/pdf/2512.18289" > <button> Read the preprint paper version</button></a>
    </p>
  </main>

  <footer id="log-footer" style="cursor: pointer;">
    <p>&copy; 2025 Marco Stefanelli</p>
  </footer>

  <nav>
    <a href="../index.html" aria-label="Back to home">⬅️</a>
  </nav>

  <script>
    // Format: yyyy-mm-dd HH:mm:ss
    function getCurrentDateTime() {
      const now = new Date();
      const date = now.toISOString().split('T')[0];
      const time = now.toTimeString().split(' ')[0];
      return `${date} ${time}`;
    }

    function getPageKey() {
      // Keep original key for storage uniqueness
      return window.location.pathname || 'unknown-page';
    }

    function makeSafeFilename(input) {
      // Remove slashes and other filename-hostile characters
      return input.replace(/[\\/:*?"<>|]/g, '_').replace(/\s+/g, '_');
    }

    const pageKey = getPageKey();
    const storageCountKey = `${pageKey}-pageViewCount`;
    const storageLogKey = `${pageKey}-logEntries`;

    // Increment page view count on load
    let pageViewCount = Number.parseInt(localStorage.getItem(storageCountKey), 10);
    if (!Number.isFinite(pageViewCount)) pageViewCount = 0;
    pageViewCount += 1;
    localStorage.setItem(storageCountKey, String(pageViewCount));

    function downloadLogFile() {
      const action = prompt(
        'Enter the password to download the log file.\n\nType "reset" to reset the counter and logs.'
      );

      const correctPassword = '3.1415926';

      if (action === null) return; // user cancelled

      // Reset flow
      if (action.trim().toLowerCase() === 'reset') {
        const resetPassword = prompt('Enter the password to reset the counter and logs:');
        if (resetPassword !== correctPassword) {
          alert('Incorrect password for reset!');
          return;
        }

        if (confirm('Are you sure you want to reset the counter and clear all log entries?')) {
          localStorage.setItem(storageCountKey, '0');
          localStorage.setItem(storageLogKey, '');
          location.reload();
        }
        return;
      }

      // Download flow
      if (action !== correctPassword) {
        alert('Incorrect password!');
        return;
      }

      const nowStamp = getCurrentDateTime();
      const previousLogs = localStorage.getItem(storageLogKey) || '';

      // Log entry
      const newLogEntry =
        `Date and Time: ${nowStamp}\n` +
        `Page View Count: ${pageViewCount}\n` +
        `Page: ${pageKey}\n` +
        `-----------------------------\n`;

      const updatedLogs = newLogEntry + previousLogs;
      localStorage.setItem(storageLogKey, updatedLogs);

      // Download
      const blob = new Blob([updatedLogs], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);

      const a = document.createElement('a');
      a.href = url;

      const safeName = makeSafeFilename(pageKey);
      a.download = `${safeName}-page-view-log.txt`;

      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);

      URL.revokeObjectURL(url);
    }

    document.addEventListener('DOMContentLoaded', () => {
      const footer = document.getElementById('log-footer');
      if (footer) footer.addEventListener('click', downloadLogFile);
    });
  </script>
</body>
</html>